\hypertarget{stella__boundary_8c}{}\section{src/stella\+\_\+boundary.c File Reference}
\label{stella__boundary_8c}\index{src/stella\+\_\+boundary.\+c@{src/stella\+\_\+boundary.\+c}}
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+boundary.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{stella__boundary_8c_ac6afabdc09a49a433ee19d8a9486056d}{min}}(a,  b)~((a) $<$= (b) ? (a) \+: (b))
\item 
\#define \mbox{\hyperlink{stella__boundary_8c_affe776513b24d84b39af8ab0930fef7f}{max}}(a,  b)~((a) $>$= (b) ? (a) \+: (b))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{stella__boundary_8c_a9c57badb8b2ad41e13c2b4361470c30e}{overlaps}} (\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc1, \mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc2)
\item 
static void \mbox{\hyperlink{stella__boundary_8c_a0640f45427bb8727020e30c9c12acab9}{intersect}} (\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc1, \mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc2, \mbox{\hyperlink{structstella__corner}{stella\+\_\+corner}} $\ast$intersection)
\item 
static int \mbox{\hyperlink{stella__boundary_8c_a4085a52ea59c4b23bb050b1b66cc166e}{points\+\_\+removed}} (int nd, \mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$patch, \mbox{\hyperlink{structstella__corner}{stella\+\_\+corner}} $\ast$intersection, int dir)
\item 
int \mbox{\hyperlink{stella__boundary_8c_aa1dc8076af0cc6d5d45569f19b0749c0}{bc\+\_\+priority}} (\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc)
\item 
static void \mbox{\hyperlink{stella__boundary_8c_a08a40b6de7e365837bc2298f01b38465}{fix\+\_\+corner}} (int nd, \mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc1, \mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$bc2)
\item 
static void \mbox{\hyperlink{stella__boundary_8c_a400dde28e6d1dd643f0eee93d03f9f4c}{handle\+\_\+corner\+\_\+overlap}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$bnd, \mbox{\hyperlink{stella__bc_8h_a8eccc1c3c3d83359ed0a620a0856d0ea}{stella\+\_\+bc}} $\ast$bc)
\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__boundary_8c_a0bbe45369b12193a3a49fc31dcc8873b}{stella\+\_\+boundary\+\_\+create}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$$\ast$stella\+\_\+bnd, \mbox{\hyperlink{structstella__level}{stella\+\_\+level}} $\ast$level, \mbox{\hyperlink{structstella__dmap}{stella\+\_\+dmap}} $\ast$dmap, \mbox{\hyperlink{structstella__state}{stella\+\_\+state}} $\ast$\mbox{\hyperlink{structstate}{state}}, \mbox{\hyperlink{structstella__fd}{stella\+\_\+fd}} $\ast$fd)
\begin{DoxyCompactList}\small\item\em Creates the boundary object for a grid. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__boundary_8c_a4989611e127be7004d2fed5b2c1c79fd}{stella\+\_\+boundary\+\_\+apply}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$bnd, Mat A, DM da)
\begin{DoxyCompactList}\small\item\em Adds boundary conditions to matrix. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__boundary_8c_a8223a286059fb61ce380ff265f52787f}{stella\+\_\+boundary\+\_\+apply\+\_\+rhs}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$bnd, DM da, Vec rhs)
\begin{DoxyCompactList}\small\item\em Adds boundary conditions to the right hand side. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__boundary_8c_a06dc69c34ccf076b12cc7d6ae0d4e6b4}{stella\+\_\+boundary\+\_\+add}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$bnd, \mbox{\hyperlink{stella__bc_8h_a7959afa0ee9aae02dd31cfce273269ce}{stella\+\_\+bctype}} \mbox{\hyperlink{boundary_8h_a421e1789e91f264d28c9fb0f244402bc}{btype}}, int norm\+\_\+dir, int is\mbox{[}$\,$\mbox{]}, int ie\mbox{[}$\,$\mbox{]}, double $\ast$dirichlet)
\begin{DoxyCompactList}\small\item\em Adds a boundary condition to a grid\textquotesingle{}s boundary. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__boundary_8c_aa4fbac998b4998fbfd30d706d4e23033}{stella\+\_\+boundary\+\_\+destroy}} (\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$bnd)
\begin{DoxyCompactList}\small\item\em Destructor for boundary. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{stella__boundary_8c_affe776513b24d84b39af8ab0930fef7f}\label{stella__boundary_8c_affe776513b24d84b39af8ab0930fef7f}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!max@{max}}
\index{max@{max}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{max}{max}}
{\footnotesize\ttfamily \#define max(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~((a) $>$= (b) ? (a) \+: (b))}

\mbox{\Hypertarget{stella__boundary_8c_ac6afabdc09a49a433ee19d8a9486056d}\label{stella__boundary_8c_ac6afabdc09a49a433ee19d8a9486056d}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!min@{min}}
\index{min@{min}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{min}{min}}
{\footnotesize\ttfamily \#define min(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~((a) $<$= (b) ? (a) \+: (b))}



\subsection{Function Documentation}
\mbox{\Hypertarget{stella__boundary_8c_aa1dc8076af0cc6d5d45569f19b0749c0}\label{stella__boundary_8c_aa1dc8076af0cc6d5d45569f19b0749c0}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!bc\+\_\+priority@{bc\+\_\+priority}}
\index{bc\+\_\+priority@{bc\+\_\+priority}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{bc\+\_\+priority()}{bc\_priority()}}
{\footnotesize\ttfamily int bc\+\_\+priority (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc }\end{DoxyParamCaption})}

\mbox{\Hypertarget{stella__boundary_8c_a08a40b6de7e365837bc2298f01b38465}\label{stella__boundary_8c_a08a40b6de7e365837bc2298f01b38465}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!fix\+\_\+corner@{fix\+\_\+corner}}
\index{fix\+\_\+corner@{fix\+\_\+corner}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{fix\+\_\+corner()}{fix\_corner()}}
{\footnotesize\ttfamily static void fix\+\_\+corner (\begin{DoxyParamCaption}\item[{int}]{nd,  }\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc1,  }\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{stella__boundary_8c_a400dde28e6d1dd643f0eee93d03f9f4c}\label{stella__boundary_8c_a400dde28e6d1dd643f0eee93d03f9f4c}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!handle\+\_\+corner\+\_\+overlap@{handle\+\_\+corner\+\_\+overlap}}
\index{handle\+\_\+corner\+\_\+overlap@{handle\+\_\+corner\+\_\+overlap}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{handle\+\_\+corner\+\_\+overlap()}{handle\_corner\_overlap()}}
{\footnotesize\ttfamily static void handle\+\_\+corner\+\_\+overlap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$}]{bnd,  }\item[{\mbox{\hyperlink{stella__bc_8h_a8eccc1c3c3d83359ed0a620a0856d0ea}{stella\+\_\+bc}} $\ast$}]{bc }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{stella__boundary_8c_a0640f45427bb8727020e30c9c12acab9}\label{stella__boundary_8c_a0640f45427bb8727020e30c9c12acab9}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!intersect@{intersect}}
\index{intersect@{intersect}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{intersect()}{intersect()}}
{\footnotesize\ttfamily static void intersect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc1,  }\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc2,  }\item[{\mbox{\hyperlink{structstella__corner}{stella\+\_\+corner}} $\ast$}]{intersection }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{stella__boundary_8c_a9c57badb8b2ad41e13c2b4361470c30e}\label{stella__boundary_8c_a9c57badb8b2ad41e13c2b4361470c30e}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!overlaps@{overlaps}}
\index{overlaps@{overlaps}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{overlaps()}{overlaps()}}
{\footnotesize\ttfamily static int overlaps (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc1,  }\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{bc2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{stella__boundary_8c_a4085a52ea59c4b23bb050b1b66cc166e}\label{stella__boundary_8c_a4085a52ea59c4b23bb050b1b66cc166e}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!points\+\_\+removed@{points\+\_\+removed}}
\index{points\+\_\+removed@{points\+\_\+removed}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{points\+\_\+removed()}{points\_removed()}}
{\footnotesize\ttfamily static int points\+\_\+removed (\begin{DoxyParamCaption}\item[{int}]{nd,  }\item[{\mbox{\hyperlink{structstella__patch}{stella\+\_\+patch}} $\ast$}]{patch,  }\item[{\mbox{\hyperlink{structstella__corner}{stella\+\_\+corner}} $\ast$}]{intersection,  }\item[{int}]{dir }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{stella__boundary_8c_a06dc69c34ccf076b12cc7d6ae0d4e6b4}\label{stella__boundary_8c_a06dc69c34ccf076b12cc7d6ae0d4e6b4}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!stella\+\_\+boundary\+\_\+add@{stella\+\_\+boundary\+\_\+add}}
\index{stella\+\_\+boundary\+\_\+add@{stella\+\_\+boundary\+\_\+add}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+boundary\+\_\+add()}{stella\_boundary\_add()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+boundary\+\_\+add (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$}]{bnd,  }\item[{\mbox{\hyperlink{stella__bc_8h_a7959afa0ee9aae02dd31cfce273269ce}{stella\+\_\+bctype}}}]{btype,  }\item[{int}]{norm\+\_\+dir,  }\item[{int}]{is\mbox{[}$\,$\mbox{]},  }\item[{int}]{ie\mbox{[}$\,$\mbox{]},  }\item[{double $\ast$}]{dirichlet }\end{DoxyParamCaption})}



Adds a boundary condition to a grid\textquotesingle{}s boundary. 


\begin{DoxyParams}{Parameters}
{\em bnd} & boundary object \\
\hline
{\em btype} & type of boundary condition (Dirichlet, Neumann, ...) \\
\hline
{\em norm\+\_\+dir} & Direction of outward normal \\
\hline
{\em is} & global index of this processors starting grid point in each dimension \\
\hline
{\em ie} & global index of this processors ending grid point in each dimension \\
\hline
{\em Dirichlet} & values of Dirichlet boundary (ignored if btype is not Dirichlet) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__boundary_8c_a4989611e127be7004d2fed5b2c1c79fd}\label{stella__boundary_8c_a4989611e127be7004d2fed5b2c1c79fd}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!stella\+\_\+boundary\+\_\+apply@{stella\+\_\+boundary\+\_\+apply}}
\index{stella\+\_\+boundary\+\_\+apply@{stella\+\_\+boundary\+\_\+apply}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+boundary\+\_\+apply()}{stella\_boundary\_apply()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+boundary\+\_\+apply (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$}]{bnd,  }\item[{Mat}]{A,  }\item[{DM}]{da }\end{DoxyParamCaption})}



Adds boundary conditions to matrix. 


\begin{DoxyParams}{Parameters}
{\em bnd} & boundary object \\
\hline
{\em A} & matrix to add boundary conditions \\
\hline
{\em da} & data structure for structured grid \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__boundary_8c_a8223a286059fb61ce380ff265f52787f}\label{stella__boundary_8c_a8223a286059fb61ce380ff265f52787f}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!stella\+\_\+boundary\+\_\+apply\+\_\+rhs@{stella\+\_\+boundary\+\_\+apply\+\_\+rhs}}
\index{stella\+\_\+boundary\+\_\+apply\+\_\+rhs@{stella\+\_\+boundary\+\_\+apply\+\_\+rhs}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+boundary\+\_\+apply\+\_\+rhs()}{stella\_boundary\_apply\_rhs()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+boundary\+\_\+apply\+\_\+rhs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$}]{bnd,  }\item[{DM}]{da,  }\item[{Vec}]{rhs }\end{DoxyParamCaption})}



Adds boundary conditions to the right hand side. 

Depending on the boundary condition and choice of implementation, the matrix and right hand side may need to be modified. 
\begin{DoxyParams}{Parameters}
{\em bnd} & boundary object \\
\hline
{\em da} & data structure for structured grid \\
\hline
{\em rhs} & right hand side vector \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__boundary_8c_a0bbe45369b12193a3a49fc31dcc8873b}\label{stella__boundary_8c_a0bbe45369b12193a3a49fc31dcc8873b}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!stella\+\_\+boundary\+\_\+create@{stella\+\_\+boundary\+\_\+create}}
\index{stella\+\_\+boundary\+\_\+create@{stella\+\_\+boundary\+\_\+create}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+boundary\+\_\+create()}{stella\_boundary\_create()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+boundary\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$$\ast$}]{stella\+\_\+bnd,  }\item[{\mbox{\hyperlink{structstella__level}{stella\+\_\+level}} $\ast$}]{level,  }\item[{\mbox{\hyperlink{structstella__dmap}{stella\+\_\+dmap}} $\ast$}]{dmap,  }\item[{\mbox{\hyperlink{structstella__state}{stella\+\_\+state}} $\ast$}]{state,  }\item[{\mbox{\hyperlink{structstella__fd}{stella\+\_\+fd}} $\ast$}]{fd }\end{DoxyParamCaption})}



Creates the boundary object for a grid. 


\begin{DoxyParams}{Parameters}
{\em stella\+\_\+bnd} & location to put newly created object \\
\hline
{\em level} & data needed on each MG level \\
\hline
{\em dmap} & efield solver\textquotesingle{}s data mapping object \\
\hline
{\em state} & state data for efield solver \\
\hline
{\em fd} & finite difference coefficients \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__boundary_8c_aa4fbac998b4998fbfd30d706d4e23033}\label{stella__boundary_8c_aa4fbac998b4998fbfd30d706d4e23033}} 
\index{stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}!stella\+\_\+boundary\+\_\+destroy@{stella\+\_\+boundary\+\_\+destroy}}
\index{stella\+\_\+boundary\+\_\+destroy@{stella\+\_\+boundary\+\_\+destroy}!stella\+\_\+boundary.\+c@{stella\+\_\+boundary.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+boundary\+\_\+destroy()}{stella\_boundary\_destroy()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+boundary\+\_\+destroy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella__boundary}{stella\+\_\+boundary}} $\ast$}]{bnd }\end{DoxyParamCaption})}



Destructor for boundary. 

