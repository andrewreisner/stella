\hypertarget{stella__solver_8c}{}\section{src/stella\+\_\+solver.c File Reference}
\label{stella__solver_8c}\index{src/stella\+\_\+solver.\+c@{src/stella\+\_\+solver.\+c}}
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+solver.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+io.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+signals.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+mat.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stella\+\_\+pc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}petscmat.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a8514558244ebba7b29a64c98c597059b}{petsc\+\_\+options\+\_\+has\+\_\+name}} (const char name\mbox{[}$\,$\mbox{]}, Petsc\+Bool $\ast$set)
\item 
static Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a7867d0f5286f79b9fac7ef10349592b6}{petsc\+\_\+options\+\_\+set\+\_\+value}} (const char name\mbox{[}$\,$\mbox{]}, const char value\mbox{[}$\,$\mbox{]})
\item 
static Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_ad58aae98b6ffa6a5a40096eebe8180a8}{stella\+\_\+setup}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, int offset\mbox{[}$\,$\mbox{]}, int stride\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Creates and initializes data needed for setting up elliptic discretization. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a00f6b15486f9468acd4e09eacff87e4a}{stella\+\_\+init}} (\mbox{\hyperlink{structstella}{stella}} $\ast$$\ast$solver\+\_\+ctx, M\+P\+I\+\_\+\+Comm comm, int n\+Global\mbox{[}$\,$\mbox{]}, int n\+Procs\mbox{[}$\,$\mbox{]}, int n\+Local\mbox{[}$\,$\mbox{]}, int offset\mbox{[}$\,$\mbox{]}, int stride\mbox{[}$\,$\mbox{]}, int cart\+Coord\mbox{[}$\,$\mbox{]}, int periodic\mbox{[}$\,$\mbox{]}, int periodic\+\_\+storage, int nd, int axisymmetric)
\begin{DoxyCompactList}\small\item\em Initializes structured elliptic solver. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a08513629aa746b1916b94f92bb1563b8}{stella\+\_\+solve}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv)
\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a30f7d812d09e481e5b47c9e7a33d3e05}{stella\+\_\+set\+\_\+state}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, double phi\mbox{[}$\,$\mbox{]}, double dcoef\mbox{[}$\,$\mbox{]}, double bcoef\mbox{[}$\,$\mbox{]}, double jump\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Sets solver state. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a5c99b371f1fbbf76816cc8b179c9aebe}{stella\+\_\+set\+\_\+sol}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, double sol\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Sets anaylitical solution for linear solve. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a609972ad16e29e8471064a8479663a42}{stella\+\_\+set\+\_\+rhs}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, double rhs\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Sets solver rhs. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a7d7aa4a39aac0b06cd529f4a22b16ae8}{stella\+\_\+set\+\_\+grid}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, int is\mbox{[}$\,$\mbox{]}, int ie\mbox{[}$\,$\mbox{]}, int num\+\_\+cells, double xyz\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Sets grid corners and Cartesian coordinates. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a38371209b2046421e2cd833061fb26c3}{stella\+\_\+setup\+\_\+op}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv)
\begin{DoxyCompactList}\small\item\em Calls all callbacks needed for setting up the matrix. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{stella__solver_8c_ae2392edba4d559c522d3084efb95f0ca}{stella\+\_\+log}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, \mbox{\hyperlink{stella__solver_8h_a6c4b3df31b9f233a9da63b147ed761d0}{stella\+\_\+log\+\_\+level}} level)
\begin{DoxyCompactList}\small\item\em Checks if log level is active. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{stella__solver_8c_a07ff1beb4186bba9714906b664f2999c}{stella\+\_\+set\+\_\+log}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv, \mbox{\hyperlink{stella__solver_8h_a6c4b3df31b9f233a9da63b147ed761d0}{stella\+\_\+log\+\_\+level}} level)
\begin{DoxyCompactList}\small\item\em Set log level for stella. \end{DoxyCompactList}\item 
Petsc\+Error\+Code \mbox{\hyperlink{stella__solver_8c_a70fc29e6bc2c5bcc25e4c4da2bab0a09}{stella\+\_\+cleanup}} (\mbox{\hyperlink{structstella}{stella}} $\ast$slv)
\begin{DoxyCompactList}\small\item\em Destroys data structures owned by the elliptic discretization. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{stella__solver_8c_a8514558244ebba7b29a64c98c597059b}\label{stella__solver_8c_a8514558244ebba7b29a64c98c597059b}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!petsc\+\_\+options\+\_\+has\+\_\+name@{petsc\+\_\+options\+\_\+has\+\_\+name}}
\index{petsc\+\_\+options\+\_\+has\+\_\+name@{petsc\+\_\+options\+\_\+has\+\_\+name}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{petsc\+\_\+options\+\_\+has\+\_\+name()}{petsc\_options\_has\_name()}}
{\footnotesize\ttfamily static Petsc\+Error\+Code petsc\+\_\+options\+\_\+has\+\_\+name (\begin{DoxyParamCaption}\item[{const char}]{name\mbox{[}$\,$\mbox{]},  }\item[{Petsc\+Bool $\ast$}]{set }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

\mbox{\Hypertarget{stella__solver_8c_a7867d0f5286f79b9fac7ef10349592b6}\label{stella__solver_8c_a7867d0f5286f79b9fac7ef10349592b6}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!petsc\+\_\+options\+\_\+set\+\_\+value@{petsc\+\_\+options\+\_\+set\+\_\+value}}
\index{petsc\+\_\+options\+\_\+set\+\_\+value@{petsc\+\_\+options\+\_\+set\+\_\+value}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{petsc\+\_\+options\+\_\+set\+\_\+value()}{petsc\_options\_set\_value()}}
{\footnotesize\ttfamily static Petsc\+Error\+Code petsc\+\_\+options\+\_\+set\+\_\+value (\begin{DoxyParamCaption}\item[{const char}]{name\mbox{[}$\,$\mbox{]},  }\item[{const char}]{value\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

\mbox{\Hypertarget{stella__solver_8c_a70fc29e6bc2c5bcc25e4c4da2bab0a09}\label{stella__solver_8c_a70fc29e6bc2c5bcc25e4c4da2bab0a09}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+cleanup@{stella\+\_\+cleanup}}
\index{stella\+\_\+cleanup@{stella\+\_\+cleanup}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+cleanup()}{stella\_cleanup()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv }\end{DoxyParamCaption})}



Destroys data structures owned by the elliptic discretization. 

\mbox{\Hypertarget{stella__solver_8c_a00f6b15486f9468acd4e09eacff87e4a}\label{stella__solver_8c_a00f6b15486f9468acd4e09eacff87e4a}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+init@{stella\+\_\+init}}
\index{stella\+\_\+init@{stella\+\_\+init}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+init()}{stella\_init()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$$\ast$}]{solver\+\_\+ctx,  }\item[{M\+P\+I\+\_\+\+Comm}]{comm,  }\item[{int}]{n\+Global\mbox{[}$\,$\mbox{]},  }\item[{int}]{n\+Procs\mbox{[}$\,$\mbox{]},  }\item[{int}]{n\+Local\mbox{[}$\,$\mbox{]},  }\item[{int}]{offset\mbox{[}$\,$\mbox{]},  }\item[{int}]{stride\mbox{[}$\,$\mbox{]},  }\item[{int}]{cart\+Coord\mbox{[}$\,$\mbox{]},  }\item[{int}]{periodic\mbox{[}$\,$\mbox{]},  }\item[{int}]{periodic\+\_\+storage,  }\item[{int}]{nd,  }\item[{int}]{axisymmetric }\end{DoxyParamCaption})}



Initializes structured elliptic solver. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em solver\+\_\+ctx} & pointer to the solver object allocated in this call \\
\hline
\mbox{\tt in}  & {\em comm} & M\+PI Communicator to be used for the efield solver \\
\hline
\mbox{\tt in}  & {\em n\+Global} & number of global grid points in each dimension \\
\hline
\mbox{\tt in}  & {\em n\+Procs} & number of processors in each dimension \\
\hline
\mbox{\tt in}  & {\em n\+Local} & number of local grid points in each dimension \\
\hline
\mbox{\tt in}  & {\em offset} & offsets of data inside Fortran arrays (e.\+g. if ghosts are included) \\
\hline
\mbox{\tt in}  & {\em stride} & strides of data inside Fortran arrays \\
\hline
\mbox{\tt in}  & {\em cart\+Coord} & Cartesian coordinate of my rank \\
\hline
\mbox{\tt in}  & {\em periodic} & flag for setting periodicity of a dimension \\
\hline
\mbox{\tt in}  & {\em periodic\+\_\+storage} & flag for duplicating grid points if periodic \\
\hline
\mbox{\tt in}  & {\em nd} & number of dimensions \\
\hline
\mbox{\tt in}  & {\em ng} & grid number \\
\hline
\mbox{\tt in}  & {\em axisymmetric} & flag for setting the solver to be axisymmetric \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__solver_8c_ae2392edba4d559c522d3084efb95f0ca}\label{stella__solver_8c_ae2392edba4d559c522d3084efb95f0ca}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+log@{stella\+\_\+log}}
\index{stella\+\_\+log@{stella\+\_\+log}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+log()}{stella\_log()}}
{\footnotesize\ttfamily int stella\+\_\+log (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{\mbox{\hyperlink{stella__solver_8h_a6c4b3df31b9f233a9da63b147ed761d0}{stella\+\_\+log\+\_\+level}}}]{level }\end{DoxyParamCaption})}



Checks if log level is active. 

\mbox{\Hypertarget{stella__solver_8c_a7d7aa4a39aac0b06cd529f4a22b16ae8}\label{stella__solver_8c_a7d7aa4a39aac0b06cd529f4a22b16ae8}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+set\+\_\+grid@{stella\+\_\+set\+\_\+grid}}
\index{stella\+\_\+set\+\_\+grid@{stella\+\_\+set\+\_\+grid}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+set\+\_\+grid()}{stella\_set\_grid()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+set\+\_\+grid (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{int}]{is\mbox{[}$\,$\mbox{]},  }\item[{int}]{ie\mbox{[}$\,$\mbox{]},  }\item[{int}]{num\+\_\+cells,  }\item[{double}]{xyz\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Sets grid corners and Cartesian coordinates. 


\begin{DoxyParams}{Parameters}
{\em slv} & solver object \\
\hline
{\em is} & global index of first grid point on this processor in each dimension \\
\hline
{\em ie} & global index of last grid point on this processor in each dimension \\
\hline
{\em num\+\_\+cells} & number of grid points on local processor \\
\hline
{\em xyz} & array of Cartesian coordinates for each grid point on this processor \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__solver_8c_a07ff1beb4186bba9714906b664f2999c}\label{stella__solver_8c_a07ff1beb4186bba9714906b664f2999c}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+set\+\_\+log@{stella\+\_\+set\+\_\+log}}
\index{stella\+\_\+set\+\_\+log@{stella\+\_\+set\+\_\+log}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+set\+\_\+log()}{stella\_set\_log()}}
{\footnotesize\ttfamily void stella\+\_\+set\+\_\+log (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{\mbox{\hyperlink{stella__solver_8h_a6c4b3df31b9f233a9da63b147ed761d0}{stella\+\_\+log\+\_\+level}}}]{level }\end{DoxyParamCaption})}



Set log level for stella. 

\mbox{\Hypertarget{stella__solver_8c_a609972ad16e29e8471064a8479663a42}\label{stella__solver_8c_a609972ad16e29e8471064a8479663a42}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+set\+\_\+rhs@{stella\+\_\+set\+\_\+rhs}}
\index{stella\+\_\+set\+\_\+rhs@{stella\+\_\+set\+\_\+rhs}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+set\+\_\+rhs()}{stella\_set\_rhs()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+set\+\_\+rhs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{double}]{rhs\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Sets solver rhs. 


\begin{DoxyParams}{Parameters}
{\em slv} & solver object \\
\hline
{\em rhs} & right hand side for linear solve \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__solver_8c_a5c99b371f1fbbf76816cc8b179c9aebe}\label{stella__solver_8c_a5c99b371f1fbbf76816cc8b179c9aebe}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+set\+\_\+sol@{stella\+\_\+set\+\_\+sol}}
\index{stella\+\_\+set\+\_\+sol@{stella\+\_\+set\+\_\+sol}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+set\+\_\+sol()}{stella\_set\_sol()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+set\+\_\+sol (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{double}]{sol\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Sets anaylitical solution for linear solve. 

This is used in testing to set the analytical solution in order to compute the error of the solve. \mbox{\Hypertarget{stella__solver_8c_a30f7d812d09e481e5b47c9e7a33d3e05}\label{stella__solver_8c_a30f7d812d09e481e5b47c9e7a33d3e05}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+set\+\_\+state@{stella\+\_\+set\+\_\+state}}
\index{stella\+\_\+set\+\_\+state@{stella\+\_\+set\+\_\+state}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+set\+\_\+state()}{stella\_set\_state()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+set\+\_\+state (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{double}]{phi\mbox{[}$\,$\mbox{]},  }\item[{double}]{dcoef\mbox{[}$\,$\mbox{]},  }\item[{double}]{bcoef\mbox{[}$\,$\mbox{]},  }\item[{double}]{jump\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Sets solver state. 


\begin{DoxyParams}{Parameters}
{\em slv} & solver object \\
\hline
{\em phi} & array where solver will put the solution \\
\hline
{\em dcoef} & permittivity of electric field \\
\hline
{\em jump} & jump condition \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{stella__solver_8c_ad58aae98b6ffa6a5a40096eebe8180a8}\label{stella__solver_8c_ad58aae98b6ffa6a5a40096eebe8180a8}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+setup@{stella\+\_\+setup}}
\index{stella\+\_\+setup@{stella\+\_\+setup}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+setup()}{stella\_setup()}}
{\footnotesize\ttfamily static Petsc\+Error\+Code stella\+\_\+setup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv,  }\item[{int}]{offset\mbox{[}$\,$\mbox{]},  }\item[{int}]{stride\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates and initializes data needed for setting up elliptic discretization. 

\mbox{\Hypertarget{stella__solver_8c_a38371209b2046421e2cd833061fb26c3}\label{stella__solver_8c_a38371209b2046421e2cd833061fb26c3}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+setup\+\_\+op@{stella\+\_\+setup\+\_\+op}}
\index{stella\+\_\+setup\+\_\+op@{stella\+\_\+setup\+\_\+op}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+setup\+\_\+op()}{stella\_setup\_op()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+setup\+\_\+op (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv }\end{DoxyParamCaption})}



Calls all callbacks needed for setting up the matrix. 

\mbox{\Hypertarget{stella__solver_8c_a08513629aa746b1916b94f92bb1563b8}\label{stella__solver_8c_a08513629aa746b1916b94f92bb1563b8}} 
\index{stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}!stella\+\_\+solve@{stella\+\_\+solve}}
\index{stella\+\_\+solve@{stella\+\_\+solve}!stella\+\_\+solver.\+c@{stella\+\_\+solver.\+c}}
\subsubsection{\texorpdfstring{stella\+\_\+solve()}{stella\_solve()}}
{\footnotesize\ttfamily Petsc\+Error\+Code stella\+\_\+solve (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstella}{stella}} $\ast$}]{slv }\end{DoxyParamCaption})}

